<!doctype html>
<html class="no-js fixed-layout">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>We-Times-个人中心</title>
    <meta name="description" content="这是一个 index 页面">
    <meta name="keywords" content="index">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="__STATIC__/AmazeUI/Cache-Control" content="no-siteapp" />
    <link rel="alternate icon" type="image/png" href="__STATIC__/img/icon.png">
    <link rel="apple-touch-icon-precomposed" href="__STATIC__/AmazeUI/assets/i/app-icon72x72@2x.png">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="stylesheet" href="__STATIC__/AmazeUI/assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="__STATIC__/AmazeUI/assets/css/admin.css">
</head>
<body>
<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
    以获得更好的体验！</p>
<![endif]-->
{include file="public/header"}
<div style="top: -50px;" class="am-cf admin-main">
    {include file="public/sidebar"}
    <!-- content start -->
    <div class="admin-content">
        <div class="admin-content-body">
            <div class="am-cf am-padding am-padding-bottom-0">
                <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">个人资料</strong> / <small>Personal information</small></div>
            </div>

            <hr/>

            <div class="am-g">
                <div class="am-u-sm-12 am-u-md-4 am-u-md-push-8">
                    <div class="am-panel am-panel-default">
                        <div class="am-panel-bd">
                            <div class="am-g">
                                <div class="am-u-md-4">
                                    {if condition="$user->icon"}
                                    <img class="am-img-circle am-img-thumbnail" src="__STATIC__/upload/images/icon/{$user->icon}" alt=""/>
                                    {else /}
                                    <img class="am-img-circle am-img-thumbnail" src="http://s.amazeui.org/media/i/demos/bw-2014-06-19.jpg?imageView/1/w/200/h/200/q/80" alt=""/>
                                    {/if}
                                </div>
                                <div class="am-u-md-8">
                                    <p>你可以使用<a href="#">We-Times.club</a>提供的头像或者使用本地上传头像。 </p>
                                    <form id="upload_pic" class="am-form" method="post" enctype="multipart/form-data">
                                        <div class="am-form-group">
                                            <input type="file" id="user-pic" name="file">
                                            <p class="am-form-help">请选择要上传的文件...</p>
                                            <button id="upload" type="button" class="am-btn am-btn-primary am-btn-xs">保存</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="am-panel am-panel-default">
                        <div class="am-panel-bd">
                            <div class="user-info">
                                <p>等级信息</p>
                                <div class="am-progress am-progress-sm">
                                    <div class="am-progress-bar" style="width: 60%"></div>
                                </div>
                                <p class="user-info-order">当前等级：<strong>LV8</strong> 活跃天数：<strong>587</strong> 距离下一级别：<strong>160</strong></p>
                            </div>
                            <div class="user-info">
                                <p>信用信息</p>
                                <div class="am-progress am-progress-sm">
                                    <div class="am-progress-bar am-progress-bar-success" style="width: 80%"></div>
                                </div>
                                <p class="user-info-order">信用等级：正常当前 信用积分：<strong>80</strong></p>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="am-u-sm-12 am-u-md-8 am-u-md-pull-4">
                    <form class="am-form am-form-horizontal" id="doc-vld-msg" method="post" action="">
                        <input style="display:none" name="uid" type="text" value="{$user->uid}">
                        <div class="am-form-group">
                            <label for="user-name" class="am-u-sm-3 am-form-label" >姓名 / Name</label>
                            <div class="am-u-sm-9">
                                <input  type="text" id="user-name" name="real_name" placeholder="姓名 / Name" required>
                                <small>输入你的名字，让我们记住你。</small>
                            </div>
                        </div>
                        <div class="am-form-group">
                            <label for="user-phone" class="am-u-sm-3 am-form-label">电话 / Telephone</label>
                            <div class="am-u-sm-9">
                                <input type="tel" id="user-phone" name="tel_number"  placeholder="输入你的电话号码 / Telephone" required>
                            </div>
                        </div>
                        <div class="am-form-group">
                            <label for="user-QQ" class="am-u-sm-3 am-form-label">QQ</label>
                            <div class="am-u-sm-9">
                                <input type="number" pattern="[0-9]*" name="qq_code" id="user-QQ" placeholder="输入你的QQ号码" required>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-weibo" class="am-u-sm-3 am-form-label">微博 / Twitter</label>
                            <div class="am-u-sm-9">
                                <input type="text" id="user-weibo" name="webo" placeholder="输入你的微博 / Twitter" required>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-weibo" class="am-u-sm-3 am-form-label">常居城市 / City</label>
                            <div class="am-u-sm-9">
                                <input type="text" id="user-city" name="city" placeholder="输入你的常居城市 / City" required>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="user-intro" class="am-u-sm-3 am-form-label">简介 / Intro</label>
                            <div class="am-u-sm-9">
                                <textarea class="" rows="5" id="user-intro" name="intro" placeholder="输入个人简介" required></textarea >
                                <small>250字以内写出你的一生...</small>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <div class="am-u-sm-9 am-u-sm-push-3">
                                <button id="submit" type="submit" class="am-btn am-btn-primary">保存修改</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <button
                style="display: none"
                id="alert"
                type="button"
                class="am-btn am-btn-primary"
                data-am-modal="{target: '#my-alert'}">
            Alert
        </button>
        <div class="am-modal am-modal-alert" id="my-alert">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">We-Times提示</div>
                <div class="am-modal-bd">
                    修改成功!
                </div>
                <div class="am-modal-footer">
                    <span class="am-modal-btn">确定</span>
                </div>
            </div>
        </div>
        <footer class="admin-content-footer">
            <hr>
            <p class="am-padding-left">© 2014 AllMobilize, Inc. Licensed under MIT license.</p>
        </footer>

    </div>
    <!-- content end -->

</div>

<a href="#" class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu" data-am-offcanvas="{target: '#admin-offcanvas'}"></a>

<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="__STATIC__/AmazeUI/assets/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="__STATIC__/AmazeUI/assets/js/jquery.min.js"></script>
<!--<![endif]-->
<script src="__STATIC__/AmazeUI/assets/js/amazeui.min.js"></script>
<script src="__STATIC__/AmazeUI/assets/js/app.js"></script>
<script>
    $(function() {
        $('#doc-vld-msg').validator({
            onValid: function(validity) {
                $(validity.field).closest('.am-form-group').find('.am-alert').hide();
            },

            onInValid: function(validity) {
                var $field = $(validity.field);
                var $group = $field.closest('.am-form-group');
                var $alert = $group.find('.am-alert');
                // 使用自定义的提示信息 或 插件内置的提示信息
                var msg = $field.data('validationMessage') || this.getValidationMessage(validity);

                if (!$alert.length) {

                }

                $alert.html(msg).show();
            }
        });
    });
</script>
<script type="text/javascript">

    $(function () {

        $("#upload").click(function () {  //提交实践


            var file = document.getElementById('user-pic').files[0]; //获取文件路径名，注意了没有files[1]这回事，已经试过坑
            console.log(document.getElementById('user-pic').files[0].name);



            var formData = new FormData();

            formData.append('file',file);


            $.ajax({
                type: "POST",
                url: "http://localhost/We-Times/public/api/User/Icon",  //同目录下的php文件
                data:formData,
                dataType:"json", //声明成功使用json数据类型回调

                //如果传递的是FormData数据类型，那么下来的三个参数是必须的，否则会报错
                cache:false,  //默认是true，但是一般不做缓存
                processData:false, //用于对data参数进行序列化处理，这里必须false；如果是true，就会将FormData转换为String类型
                contentType:false,  //一些文件上传http协议的关系，自行百度，如果上传的有文件，那么只能设置为false
                success : function(data){
                    if (data.status == 1){
                        alert('上传成功!');
                        window.location.reload();
                    }
                    else{
                        alert('上传失败!');

                    }

                }
            });

        });


    })

</script>

</body>
</html>
